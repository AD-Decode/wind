---
title: "Absolute Winding Number Differentiates Spatial Navigation Strategies with Genetic Risk for Alzheimer's disease"
author: "Alex Badea"
date: "10/6/2021"
output: pdf_document
toc: true
---
# Data sources

We evaluate genotype and sex differences in mouse models of Alzheimer's disease risk, based on APOE alleles: APOE2 is protective, APOE3 is control, and APOE4 represents genetic risk for AD. One allele increases risk by 3 times, and two APOE4 alleles increase risk by 10 times (ref) in relation to APOE3 . We use multiple data sources:

> Morris Water Maze - testing spatial navigation memory

> Segmentation: regional volumes

> Microstructural properties: FA

> Tractography Based Connectivity: Degree, and Clustering Coefficient

##Setup

We read the data and normalize volumes to the whole brain.

```{r setup, include=FALSE, echo=FALSE,warning = FALSE}


knitr::opts_chunk$set(echo=FALSE,warning = FALSE)
library(tidyverse)
library(export)
library(gridExtra)
library(scales)
library(ggplot2)
library(cowplot)
library(gplots)
library(tidyverse)
library(patternplot)
library(lme4)
library(visreg)
library(tidyr)
library(magrittr) 
library(dplyr)
library(ggpubr)
library(lme4)
library(lsmeans)
library(emmeans)
library(multcomp)
library(zoo)
#knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, echo = FALSE)

data <- read.csv("/Users/alex/AlexBadea_MyPapers/DavidDunson/dropbox/WindingNumber/APOE22APOE33APOE44Young_FA.csv")

data_FA <- read.csv("/Users/alex/AlexBadea_MyPapers/DavidDunson/dropbox/WindingNumber/APOE22APOE33APOE44Young_FA.csv")

data_VOL <- read.csv("/Users/alex/AlexBadea_MyPapers/DavidDunson/dropbox/WindingNumber/APOE22APOE33APOE44Young_VOL.csv")

data_DEG<-read.csv("/Users/alex/AlexBadea_MyPapers/DavidDunson/dropbox/WindingNumber/APOE22APOE33APOE44Young_DEG.csv")

data_CLUS<-read.csv("/Users/alex/AlexBadea_MyPapers/DavidDunson/dropbox/WindingNumber/APOE22APOE33APOE44Young_CLUS.csv")

outpath='/Users/alex/AlexBadea_MyPapers/DavidDunson/Figures/'

#?data_FA$APOE<-as.factor(data_FA$APOE)?

data_FA <- data_FA %>% 
   filter(Genotype != "HN") 
data_FA$APOE=data_FA$Genotype

data_VOL <- data_VOL %>% 
   filter(Genotype != "HN") 

data_VOL[,15:347]=data_VOL[,15:347]/data_VOL[,348]
data_VOL$APOE=data_VOL$Genotype

data_DEG <- data_DEG %>% 
   filter(Genotype != "HN") 
data_DEG$APOE=data_DEG$Genotype

data_CLUS <- data_CLUS %>% 
   filter(Genotype != "HN") 
data_CLUS$APOE=data_CLUS$Genotype


# separating by sex
geno_combined_FA <- data_FA
combo_f_FA <- geno_combined_FA %>% 
  filter(Sex == "female")
combo_m_FA <- geno_combined_FA %>% 
  filter(Sex == "male")

geno_combined_VOL <- data_VOL
combo_f_VOL <- geno_combined_VOL %>% 
  filter(Sex == "female")
combo_m_VOL <- geno_combined_VOL %>% 
  filter(Sex == "male")

geno_combined_DEG <- data_DEG
combo_f_DEG <- geno_combined_DEG %>% 
  filter(Sex == "female")
combo_m_DEG <- geno_combined_DEG %>% 
  filter(Sex == "male")

geno_combined_CLUS <- data_CLUS
combo_f_CLUS <- geno_combined_CLUS %>% 
  filter(Sex == "female")
combo_m_CLUS <- geno_combined_CLUS %>% 
  filter(Sex == "male")

```


# Plots for Winding Number

We embed plots for day 5 and day 8 probe trials:

```{r winding number plots, echo=FALSE, warning=FALSE}
plot1<-ggplot(data_FA, aes(Sex, Probe_d5, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "WN: Probe Day 5")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "WN: Probe day 5", title = "Winding Number Probe Day 5 ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw() 
 

plot2<-ggplot(data_FA, aes(Sex, Probe_d8, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "WN: Probe Day 5")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "WN: Probe day 8", title = "Winding Number Probe Day 8 ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  
 
ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

print('Probe day 5') 

lm_Probe_d5 <- lm(Probe_d5 ~ Genotype*Sex, geno_combined_FA)
lm_Probe_d8 <- lm(Probe_d8 ~ Genotype*Sex, geno_combined_FA)

summary(lm_Probe_d5)
lm_Probe_d5_f <- lm(Probe_d5 ~ Genotype, combo_f_FA)
summary(lm_Probe_d5_f)
lm_Probe_d5_m <- lm(Probe_d5 ~ Genotype, combo_m_FA)
summary(lm_Probe_d5_m)
anova(lm_Probe_d5)
anova(lm_Probe_d5_f)
anova(lm_Probe_d5_m)


Probe_d5.emm <- emmeans(lm_Probe_d5 , ~ Genotype | Sex, adjust = "sidak")
Probe_d8.emm <- emmeans(lm_Probe_d8 , ~ Genotype | Sex, adjust = "sidak")

#post hoc comparison
contrast(Probe_d5.emm, simple = c("Genotype", "Sex")) #FDR
contrast(Probe_d5.emm, simple = list("Genotype", "Sex"))
print('Probe Day 5 Abs Winding Number')
emmip(lm_Probe_d5, ~ Genotype | Sex )
print('Probe Day 8 Abs Winding Number')
emmip(lm_Probe_d8, ~ Genotype | Sex )

tw.emm <- contrast(Probe_d5.emm, interaction = c(Genotype = "poly", Sex = "consec"),
by = NULL)
tw.emm # see the estimates
coef(tw.emm) # see the contrast coefficients


#post hoc Tukey below

sink(paste(outpath,'Probe_d5_tukeytable.txt', sep=''))
summary(glht(lm_Probe_d5, emm(pairwise ~ Genotype*Sex, contr="sidak"))) #consider save to file
sink()
sink(paste(outpath, "Winding_ProbeD5_TukeyViolin.txt"))
emmeans(lm_Probe_d5, ~ Genotype*Sex, contr="tukey")
sink()
sink(paste(outpath, "Winding_ProbeD5_TukeyShortViolin.txt"))
mypairs<-pairs(Probe_d5.emm) #_consider save to file
#pairs(Probe_d5.emm)
pairs(Probe_d5.emm, by="Genotype")
pairs(Probe_d5.emm, by="Sex")
sink()

#omnibus testing
#https://cran.r-project.org/web/packages/emmeans/vignettes/confidence-intervals.html#adjust
sink()
sink(paste(outpath, "Winding_ProbeD5_omnibus.txt"))
test(mypairs, joint = TRUE, adjust = "sidak")
joint_tests(ref_grid(lm_Probe_d5))
joint_tests(ref_grid(lm_Probe_d5), by = "Sex", adjust = "sidak")
joint_tests(ref_grid(lm_Probe_d5), by = "Genotype",adjust = "sidak" )
sink()

res<-summary(glht(lm_Probe_d5, emm(pairwise ~ Genotype*Sex))) #consider save to file
summary(as.glht(pairs(Probe_d5.emm), by = NULL))
summary(glht(lm_Probe_d5, emm(pairwise ~ Genotype | Sex)))


plot(Probe_d5.emm, by = NULL, comparisons = TRUE, adjust = "mvt",
horizontal = FALSE, colors = "darkgreen", main ="Probe Day 5")


Probe_d5.rg <- ref_grid(lm_Probe_d5)
# Do all pairwise comparisons within rows or within columns,
# all considered as one faily of tests:
g.s <- pairs(emmeans(Probe_d5.rg, ~ Genotype | Sex))
s.g <- pairs(emmeans(Probe_d5.rg, ~ Sex | Genotype))
rbind(g.s, s.g, adjust = "mvt")
update(g.s + g.s, adjust = "fdr") ## same as above except for adjustment



print('Probe day 8') 

lm_Probe_d8 <- lm(Probe_d8 ~ Genotype*Sex, geno_combined_FA)
summary(lm_Probe_d8)
lm_Probe_d8_f <- lm(Probe_d8 ~ Genotype, combo_f_FA)
summary(lm_Probe_d8_f)
lm_Probe_d8_m <- lm(Probe_d8 ~ Genotype, combo_m_FA)
summary(lm_Probe_d8_m)
anova(lm_Probe_d8)
anova(lm_Probe_d8_f)
anova(lm_Probe_d8_m)

#https://rdrr.io/cran/multcomp/man/glht.html
sink(paste(outpath,'Probe_d8_tukeytable.txt', sep=''))
summary(glht(lm_Probe_d8, emm(pairwise ~ Genotype*Sex))) #consider save to file
sink()
sink(paste(outpath, "Winding_ProbeD8_TukeyViolin.txt"))
emmeans(lm_Probe_d8, ~ Genotype*Sex, contr="tukey")
sink()
sink(paste(outpath, "Winding_ProbeD8_TukeyShortViolin.txt"))
pairs(Probe_d8.emm) #_consider save to file
sink()


```

# Plots for Volume

>Hippocampus, Caudate Putamen, Brain

```{r volume_plots, echo=FALSE,  warning=FALSE}



#----

par(mfrow=c(1,3))


#----




plot1<-ggplot(data_VOL, aes(Sex, Hc, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "Hc Volume")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "Hc Volume (% of Brain)", title = "Hc Volume (% of Brain ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  
 

plot2<-ggplot(data_VOL, aes(Sex, CPu, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "CPu Volume")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "CPu Volume (% of Brain)", title = "CPu Volume (% of Brain ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

plot3<-ggplot(data_VOL, aes(Sex, Brain, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "Brain Volume")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "Brain Volume (mm3)", title = "Brain Volume (mm3 ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw() 

ggsave(paste(outpath,'Brain3_Volume.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
 par(mfrow = c(1, 1))
 
 #----
ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5)
 
ggdraw() + 
  draw_plot(plot3, 0, .5, 1, .5)
  
line1<-ggline(data_VOL,  x='Genotype', y='Brain', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Brain Volume (mm3)', legend='top')

line_Sex<-ggline(data_VOL,  x='Genotype', y='Brain', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Brain Volume (mm3)', legend='top',facet.by = "Sex")    #theme(aspect.ratio=0.5)
  
#grid.draw(cbind(line1, line_Sex, size="last"))



# Add labels to the arranged plots
#http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/81-ggplot2-easy-way-to-mix-multiple-graphs-on-the-same-page/
# gt <- arrangeGrob(line1,                               # bar plot spaning two columns
#              line_Sex, line1,                               # box plot and scatter plot
#              ncol = 2, nrow = 2, 
#              layout_matrix = rbind(c(1,1), c(2,3)))
# # Add labels to the arranged plots
# p <- as_ggplot(gt) +                                # transform to a ggplot
#   draw_plot_label(label = c("A", "B", "C"), size = 15,
#                   x = c(0, 0, 0.5), y = c(1, 0.5, 0.5)) # Add labels
# p



figure <- ggarrange(line1, line_Sex,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1, heights=c(2,1))
ggexport(figure, filename = paste(outpath,'Brain3Panels_Volume.pdf',sep=''))

ggline(data_VOL,  x='Genotype', y='CPu', color='Sex', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se',
       point.size=1.5, xlab='', ylab='CPu Volume (% of Brain)', legend='top')
ggsave(paste(outpath,'CPu_Volume.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_VOL,  x='Genotype', y='CPu', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='CPu Volume (% of Brain)', legend='top',facet.by="Sex")
ggsave(paste(outpath,'CPu_VolumebySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

####
lm_HcVol <- lm(Hc ~ Genotype*Sex, geno_combined_VOL)
sink(paste(outpath, "HcVOL_Tukey"))
emmeans(lm_HcVol, ~ Genotype*Sex, contr="tukey")
sink()

sink(paste(outpath, "HcVol_singlestep"))
summary(glht(lm_HcVol, emm(pairwise ~ Genotype*Sex))) #consider save to file
sink()


lm_CPuVol <- lm(CPu ~ Genotype*Sex, geno_combined_VOL)
sink(paste(outpath, "CPuVOL_Tukey"))
emmeans(lm_CPuVol, ~ Genotype*Sex, contr="tukey")
#pairs(Probe_d5.emm)
sink()

sink(paste(outpath, "CPuVol_singlestep"))
summary(glht(lm_CPuVol, emm(pairwise ~ Genotype*Sex))) #consider save to file
sink()
####

ggline(data_FA,  x='APOE', y='CPu', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='CPu FA', legend='top')
ggsave(paste(outpath,'CPu_FA.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_FA,  x='APOE', y='CPu', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='CPu FA', legend='top',facet.by="Sex")
ggsave(paste(outpath,'CPu_FAbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_DEG,  x='APOE', y='CPu', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='CPu Deg', legend='top')
ggsave(paste(outpath,'CPu_DEG.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_DEG,  x='APOE', y='CPu', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='CPu Deg', legend='top',facet.by="Sex")
ggsave(paste(outpath,'CPu_DEGbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_CLUS,  x='APOE', y='CPu', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='CPu Clus', legend='top')
ggsave(paste(outpath,'CPu_CLUS.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_CLUS,  x='APOE', y='CPu', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='CPu Clus', legend='top',facet.by="Sex")
ggsave(paste(outpath,'CPu_CLUSbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)



print('Hc Volume') 

ggline(data_VOL,  x='Genotype', y='Hc', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Hc Volume (% of Brain)', legend='top')
ggsave(paste(outpath,'Hc_Volume.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_VOL,  x='Genotype', y='Hc', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Hc Volume (% of Brain)', legend='top', facet.by="Sex")
ggsave(paste(outpath,'Hc_VolumebySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)



ggline(data_FA,  x='APOE', y='Hc', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Hc FA', legend='top')
ggsave(paste(outpath,'Hc_FA.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_FA,  x='APOE', y='Hc', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Hc FA', legend='top',facet.by="Sex")
ggsave(paste(outpath,'Hc_FAbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_DEG,  x='APOE', y='Hc', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Hc Deg', legend='top')
ggsave(paste(outpath,'Hc_DEG.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_DEG,  x='APOE', y='Hc', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Hc Deg', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'Hc_DEGbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_CLUS,  x='APOE', y='Hc', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Hc Clus', legend='top')
ggsave(paste(outpath,'Hc_CLUS.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_CLUS,  x='APOE', y='Hc', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='Hc Clus', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'Hc_CLUSbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)


lm_Hc <- lm(Hc ~ Genotype*Sex, geno_combined_VOL)
summary(lm_Hc)


lm_Hc_f <- lm(Hc ~ Genotype, combo_f_VOL)
summary(lm_Hc_f)
lm_Hc_m <- lm(Hc ~ Genotype, combo_m_VOL)
summary(lm_Hc_m)
anova(lm_Hc)
anova(lm_Hc_f)
anova(lm_Hc_m)


print('CPu Volume') 

lm_CPu <- lm(CPu ~ Genotype*Sex, geno_combined_VOL)
summary(lm_CPu)
lm_CPu_f <- lm(CPu ~ Genotype, combo_f_VOL)
summary(lm_CPu_f)
lm_CPu_m <- lm(CPu ~ Genotype, combo_m_VOL)
summary(lm_CPu_m)
anova(lm_CPu)
anova(lm_CPu_f)
anova(lm_CPu_m)


print('Brain Volume') 

lm_Brain <- lm(Brain ~ Genotype*Sex, geno_combined_VOL)
summary(lm_Brain)
lm_Brain_f <- lm(Brain ~ Genotype, combo_f_VOL)
summary(lm_Brain_f)
lm_Brain_m <- lm(Brain ~ Genotype, combo_m_VOL)
summary(lm_Brain_m)
anova(lm_Brain)
anova(lm_Brain_f)
anova(lm_Brain_m)

```

# Plots for FA

Gray Matter of hippocampus and caudate putamen (Hc and CPu) ; white matter of fimbria (fi), fornix (fx) and internal capsule (ic)

```{r FA_plots, echo=FALSE,  warning=FALSE}

#----
ggline(data_VOL,  x='Genotype', y='fi', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fi Volume (% of Brain)', legend='top')
ggsave(paste(outpath,'fi_Volume.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_VOL,  x='Genotype', y='fi', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fi Volume (% of Brain)', legend='top', facet.by = "Sex")
ggsave(paste(outpath,'fi_VolumeBySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)


ggline(data_FA,  x='APOE', y='fi', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fi FA', legend='top')
ggsave(paste(outpath,'fi_FA.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_FA,  x='APOE', y='fi', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fi FA', legend='top', facet.by = "Sex")
ggsave(paste(outpath,'fi_FAbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_DEG,  x='APOE', y='fi', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fi Deg', legend='top')
ggsave(paste(outpath,'fi_DEG.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_DEG,  x='APOE', y='fi', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fi Deg', legend='top', facet.by = "Sex")
ggsave(paste(outpath,'fi_DEGbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_CLUS,  x='APOE', y='fi', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fi Clus', legend='top')
ggsave(paste(outpath,'fi_CLUS.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_CLUS,  x='APOE', y='fi', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fi Clus', legend='top', facet.by = "Sex")
ggsave(paste(outpath,'fi_CLUS.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)


ggline(data_VOL,  x='Genotype', y='cbw', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='cbw Volume (% of Brain)', legend='top')
ggsave(paste(outpath,'cbw_Volume.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_VOL,  x='Genotype', y='cbw', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='cbw Volume (% of Brain)', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'cbw_VolumebbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)


ggline(data_FA,  x='APOE', y='cbw', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='cbw FA', legend='top')
ggsave(paste(outpath,'cbw_FA.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_FA,  x='APOE', y='cbw', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='cbw FA', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'cbw_FAbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_DEG,  x='APOE', y='cbw', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='cbw Deg', legend='top')
ggsave(paste(outpath,'cbw_DEG.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_DEG,  x='APOE', y='cbw', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='cbw Deg', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'cbw_DEBySexG.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_CLUS,  x='APOE', y='cbw', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='cbw Clus', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'cbw_CLUSbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)



ggline(data_VOL,  x='Genotype', y='ic', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='ic Volume (% of Brain)', legend='top')
ggsave(paste(outpath,'ic_Volume.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_VOL,  x='Genotype', y='ic', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='ic Volume (% of Brain)', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'ic_VolumeBySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)


ggline(data_FA,  x='APOE', y='ic', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='ic FA', legend='top')
ggsave(paste(outpath,'ic_FA.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_FA,  x='APOE', y='ic', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='ic FA', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'ic_FABySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_DEG,  x='APOE', y='ic', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='ic Deg', legend='top')
ggsave(paste(outpath,'ic_DEG.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_DEG,  x='APOE', y='ic', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='ic Deg', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'ic_DEGbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_CLUS,  x='APOE', y='ic', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='ic Clus', legend='top')
ggsave(paste(outpath,'ic_CLUS.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_CLUS,  x='APOE', y='ic', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='ic Clus', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'ic_CLUSbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)


ggline(data_VOL,  x='Genotype', y='fx', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fx Volume (% of Brain)', legend='top')
ggsave(paste(outpath,'fx_Volume.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_VOL,  x='Genotype', y='fx', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fx Volume (% of Brain)', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'fx_VolumebySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_FA,  x='APOE', y='fx', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fx FA', legend='top')
ggsave(paste(outpath,'fx_FA.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_FA,  x='APOE', y='fx', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fx FA', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'fx_FAbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_DEG,  x='APOE', y='fx', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fx Deg', legend='top')
ggsave(paste(outpath,'fx_DEG.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_DEG,  x='APOE', y='fx', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fx Deg', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'fx_DEGbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)

ggline(data_CLUS,  x='APOE', y='fx', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fx Clus', legend='top')
ggsave(paste(outpath,'fx_CLUS.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)
ggline(data_CLUS,  x='APOE', y='fx', color='APOE', fill='APOE', #data_VOL
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red'), size=1,
       point.size=1.5, xlab='', ylab='fx Clus', legend='top',facet.by = "Sex")
ggsave(paste(outpath,'fx_CLUSbySex.pdf',sep=''), plot = last_plot(), device='pdf',
       scale=1, width=5, height=5, unit=c("in"), dpi=300)





#---


plot1<-ggplot(data_FA, aes(Sex, Hc, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "Hc FA")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "Hc FA", title = "Hc FA ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  
 

plot2<-ggplot(data_FA, aes(Sex, CPu, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "CPu FA")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "CPu FA", title = "CPu FA ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

plot3<-ggplot(data_FA, aes(Sex, fi, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "fi FA")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "fi FA", title = "fi FA ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  
 

plot4<-ggplot(data_FA, aes(Sex, ic, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "ic FA")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "ic FA", title = "ic FA ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

plot5<-ggplot(data_FA, aes(Sex, fx, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "fx FA")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "fx FA", title = "fx FA ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

 
ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5)
 
ggdraw() + 
  draw_plot(plot3, 0, .5, 1, .5) +
  draw_plot(plot4, 0, 0, 1, .5)
  
ggdraw() + 
  draw_plot(plot5, 0, .5, 1, .5)

print('Hc FA') 

lm_Hc <- lm(Hc ~ Genotype*Sex, geno_combined_FA)
summary(lm_Hc)
lm_Hc_f <- lm(Hc ~ Genotype, combo_f_FA)
summary(lm_Hc_f)
lm_Hc_m <- lm(Hc ~ Genotype, combo_m_FA)
summary(lm_Hc_m)
anova(lm_Hc)
anova(lm_Hc_f)
anova(lm_Hc_m)


print('CPu FA') 

lm_CPu <- lm(CPu ~ Genotype*Sex, geno_combined_FA)
summary(lm_CPu)
lm_CPu_f <- lm(CPu ~ Genotype, combo_f_FA)
summary(lm_CPu_f)
lm_CPu_m <- lm(CPu ~ Genotype, combo_m_FA)
summary(lm_CPu_m)
anova(lm_CPu)
anova(lm_CPu_f)
anova(lm_CPu_m)



print('fi FA') 

lm_fi <- lm(fi ~ Genotype*Sex, geno_combined_FA)
summary(lm_fi)
lm_fi_f <- lm(fi ~ Genotype, combo_f_FA)
summary(lm_fi_f)
lm_fi_m <- lm(fi ~ Genotype, combo_m_FA)
summary(lm_fi_m)
anova(lm_fi)
anova(lm_fi_f)
anova(lm_fi_m)


print('ic FA') 

lm_ic <- lm(ic ~ Genotype*Sex, geno_combined_FA)
summary(lm_ic)
lm_ic_f <- lm(ic ~ Genotype, combo_f_FA)
summary(lm_ic_f)
lm_ic_m <- lm(ic ~ Genotype, combo_m_FA)
summary(lm_ic_m)
anova(lm_ic)
anova(lm_ic_f)
anova(lm_ic_m)


print('fx FA') 

lm_fx <- lm(fx ~ Genotype*Sex, geno_combined_FA)
summary(lm_fx)
lm_fx_f <- lm(fx ~ Genotype, combo_f_FA)
summary(lm_fx_f)
lm_fx_m <- lm(fx ~ Genotype, combo_m_FA)
summary(lm_fx_m)
anova(lm_fx)
anova(lm_fx_f)
anova(lm_fx_m)

```

# Plots for Connectivity Degree

>Hc and CPu

```{r DEG_plots, echo=FALSE,  warning=FALSE}

##Plots for Degree of Connectivity: Hc and CPu
plot1<-ggplot(data_DEG, aes(Sex, Hc, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "Hc DEG")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "Hc DEG", title = "Hc DEG ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  
 

plot2<-ggplot(data_DEG, aes(Sex, CPu, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "CPu DEG")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "CPu DEG", title = "CPu DEG ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

plot3<-ggplot(data_DEG, aes(Sex, fi, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "fi DEG")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "fi DEG", title = "fi DEG ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  
 

plot4<-ggplot(data_DEG, aes(Sex, ic, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "ic DEG")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "ic DEG", title = "ic DEG ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

plot5<-ggplot(data_DEG, aes(Sex, fx, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "fx DEG")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "fx DEG", title = "fx DEG ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

 
ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5)
 
ggdraw() + 
  draw_plot(plot3, 0, .5, 1, .5) +
  draw_plot(plot4, 0, 0, 1, .5)
  
ggdraw() + 
  draw_plot(plot5, 0, .5, 1, .5)

print('Hc DEG') 

lm_Hc <- lm(Hc ~ Genotype*Sex, geno_combined_DEG)
summary(lm_Hc)
lm_Hc_f <- lm(Hc ~ Genotype, combo_f_DEG)
summary(lm_Hc_f)
lm_Hc_m <- lm(Hc ~ Genotype, combo_m_DEG)
summary(lm_Hc_m)
anova(lm_Hc)
anova(lm_Hc_f)
anova(lm_Hc_m)


print('CPu DEG') 

lm_CPu <- lm(CPu ~ Genotype*Sex, geno_combined_DEG)
summary(lm_CPu)
lm_CPu_f <- lm(CPu ~ Genotype, combo_f_DEG)
summary(lm_CPu_f)
lm_CPu_m <- lm(CPu ~ Genotype, combo_m_DEG)
summary(lm_CPu_m)
anova(lm_CPu)
anova(lm_CPu_f)
anova(lm_CPu_m)

print('fi DEG') 

lm_fi <- lm(fi ~ Genotype*Sex, geno_combined_DEG)
summary(lm_fi)
lm_fi_f <- lm(fi ~ Genotype, combo_f_DEG)
summary(lm_fi_f)
lm_fi_m <- lm(fi ~ Genotype, combo_m_DEG)
summary(lm_fi_m)
anova(lm_fi)
anova(lm_fi_f)
anova(lm_fi_m)

print('ic DEG')
lm_ic <- lm(ic ~ Genotype*Sex, geno_combined_DEG)
summary(lm_ic)
lm_ic_f <- lm(ic ~ Genotype, combo_f_DEG)
summary(lm_ic_f)
lm_ic_m <- lm(ic ~ Genotype, combo_m_DEG)
summary(lm_ic_m)
anova(lm_ic)
anova(lm_ic_f)
anova(lm_ic_m)



print('fx DEG') 

lm_fx <- lm(fx ~ Genotype*Sex, geno_combined_DEG)
summary(lm_fx)
lm_fx_f <- lm(fx ~ Genotype, combo_f_DEG)
summary(lm_fx_f)
lm_fx_m <- lm(fx ~ Genotype, combo_m_DEG)
summary(lm_fx_m)
anova(lm_fx)
anova(lm_fx_f)
anova(lm_fx_m)

```

# Plots for Clustering Coefficient

> Hc and CPu, fi, fx, ic

```{r CLUS_plots, echo=FALSE,  warning=FALSE}

plot1<-ggplot(data_CLUS, aes(Sex, Hc, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "Hc CLUS")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "Hc CLUS", title = "Hc CLUS ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  
 

plot2<-ggplot(data_CLUS, aes(Sex, CPu, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "CPu CLUS")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "CPu CLUS", title = "CPu CLUS ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

plot3<-ggplot(data_CLUS, aes(Sex, fi, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "fi CLUS")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "fi CLUS", title = "fi CLUS ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  
 

plot4<-ggplot(data_CLUS, aes(Sex, ic, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "ic CLUS")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "ic CLUS", title = "ic CLUS ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

plot5<-ggplot(data_CLUS, aes(Sex, fx, fill = Sex)) +
  geom_violin(alpha = 0.5) +
  facet_grid(. ~ Genotype)  +
  #geom_boxplot(width = 0.1, outlier.color = "red") +
  geom_jitter(size = 0.01, height = 0, width = 0.1, aes(color = Sex)) + 
  geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1))+
  labs(title = "fx CLUS")+
  theme_minimal()+
  background_grid(major = 'xy', minor = "none") + # add thin horizontal lines 
  panel_border() + 
  theme_bw()+
  labs(x = "genotype", y = "fx CLUS", title = "fx CLUS ") +
geom_dotplot(binaxis='y', stackdir='center',
                 position=position_dodge(1)) +
stat_summary(fun.y=median, geom="point", size=2, color="black") +
 theme_bw()  

 
ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5)
 
ggdraw() + 
  draw_plot(plot3, 0, .5, 1, .5) +
  draw_plot(plot4, 0, 0, 1, .5)
  
ggdraw() + 
  draw_plot(plot5, 0, .5, 1, .5)

print('Hc CLUS') 

lm_Hc <- lm(Hc ~ Genotype*Sex, geno_combined_CLUS)
summary(lm_Hc)
lm_Hc_f <- lm(Hc ~ Genotype, combo_f_CLUS)
summary(lm_Hc_f)
lm_Hc_m <- lm(Hc ~ Genotype, combo_m_CLUS)
summary(lm_Hc_m)
anova(lm_Hc)
anova(lm_Hc_f)
anova(lm_Hc_m)


print('CPu CLUS') 

lm_CPu <- lm(CPu ~ Genotype*Sex, geno_combined_CLUS)
summary(lm_CPu)
lm_CPu_f <- lm(CPu ~ Genotype, combo_f_CLUS)
summary(lm_CPu_f)
lm_CPu_m <- lm(CPu ~ Genotype, combo_m_CLUS)
summary(lm_CPu_m)
anova(lm_CPu)
anova(lm_CPu_f)
anova(lm_CPu_m)

print('fi CLUS') 

lm_fi <- lm(fi ~ Genotype*Sex, geno_combined_CLUS)
summary(lm_fi)
lm_fi_f <- lm(fi ~ Genotype, combo_f_CLUS)
summary(lm_fi_f)
lm_fi_m <- lm(fi ~ Genotype, combo_m_CLUS)
summary(lm_fi_m)
anova(lm_fi)
anova(lm_fi_f)
anova(lm_fi_m)

print('ic CLUS')
lm_ic <- lm(ic ~ Genotype*Sex, geno_combined_CLUS)
summary(lm_ic)
lm_ic_f <- lm(ic ~ Genotype, combo_f_CLUS)
summary(lm_ic_f)
lm_ic_m <- lm(ic ~ Genotype, combo_m_CLUS)
summary(lm_ic_m)
anova(lm_ic)
anova(lm_ic_f)
anova(lm_ic_m)



print('fx CLUS') 

lm_fx <- lm(fx ~ Genotype*Sex, geno_combined_CLUS)
summary(lm_fx)
lm_fx_f <- lm(fx ~ Genotype, combo_f_CLUS)
summary(lm_fx_f)
lm_fx_m <- lm(fx ~ Genotype, combo_m_CLUS)
summary(lm_fx_m)
anova(lm_fx)
anova(lm_fx_f)
anova(lm_fx_m)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
